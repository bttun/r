name: CI

on: [push]

jobs:
  build:

    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v1
    - name: Run a one-line script
      run: echo Hello, world!
    - name: Run a multi-line script
      run: |
        echo Add other actions to build,
        echo test, and deploy your project.
    - name: Gen sidebar.md
      run: find . -mindepth 2 -name "*.md" | awk -F'/' 'BEGIN {RS=".md"} {arr[$2]=arr[$2]"\n    - ["$3"](/"$2"/"$3")"} END { num = asorti(arr, indices); for (i=1; i<=num; ++i) if (indices[i]) print "- "indices[i], arr[indices[i]]}' > _sidebar.md
    - name: test find
      run: find . -mindepth 2 -name "*.md"
    - name: test find echo
      run: find . -mindepth 2 -name "*.md" > _sidebar.md
    - name: echo _sidebar.md
      run: echo Hello, world! > _sidebar.md
    - name: cat _sidebar.md
      run: cat _sidebar.md
    - name: find .md
      run: find . -name "*.md"
    - name: find .md
      run: find . -name "_sidebar.md"
